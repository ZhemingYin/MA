2025-03-21 00:51:25,233 - ------------------------Loading TFRecord files------------------------
2025-03-21 00:51:25,578 - Preparing the datasets now...
2025-03-21 00:53:27,054 - Train set is prepared
2025-03-21 00:53:52,767 - Validation set is prepared
2025-03-21 00:54:06,816 - Test set is prepared
2025-03-21 00:54:06,820 - ------------------------Finish preparing the datasets------------------------
2025-03-21 00:54:07,008 - The model conditional_gan is loaded successfully
2025-03-21 00:54:07,044 - ------------------------Start the training process------------------------
2025-03-21 00:54:07,439 - Start of epoch 1
2025-03-21 00:54:41,888 - None
2025-03-21 00:54:41,897 - None
2025-03-21 00:54:51,490 - epoch 1, Train Loss: 0.6565831899642944, Time taken: 44.04893469810486.
2025-03-21 00:54:53,060 - Start of epoch 2
2025-03-21 00:55:18,108 - epoch 2, Train Loss: 0.42588528990745544, Time taken: 25.04576826095581.
2025-03-21 00:55:19,313 - Start of epoch 3
2025-03-21 00:55:38,368 - epoch 3, Train Loss: 0.41757962107658386, Time taken: 19.05331516265869.
2025-03-21 00:55:39,366 - Start of epoch 4
2025-03-21 00:56:03,755 - epoch 4, Train Loss: 0.41317689418792725, Time taken: 24.38790249824524.
2025-03-21 00:56:04,789 - Start of epoch 5
2025-03-21 00:56:32,360 - epoch 5, Train Loss: 0.41105327010154724, Time taken: 27.57048487663269.
2025-03-21 00:56:33,409 - Start of epoch 6
2025-03-21 00:56:58,895 - epoch 6, Train Loss: 0.41009390354156494, Time taken: 25.48469853401184.
2025-03-21 00:56:59,919 - Start of epoch 7
2025-03-21 00:57:22,812 - epoch 7, Train Loss: 0.4087581932544708, Time taken: 22.890985250473022.
2025-03-21 00:57:23,786 - Start of epoch 8
2025-03-21 00:57:53,270 - epoch 8, Train Loss: 0.40736091136932373, Time taken: 29.482693672180176.
2025-03-21 00:57:54,680 - Start of epoch 9
2025-03-21 00:58:18,354 - epoch 9, Train Loss: 0.4053209722042084, Time taken: 23.672595739364624.
2025-03-21 00:58:19,301 - Start of epoch 10
2025-03-21 00:58:39,594 - epoch 10, Train Loss: 0.40194547176361084, Time taken: 20.291572093963623.
2025-03-21 00:58:47,114 - Start of epoch 11
2025-03-21 00:59:11,781 - epoch 11, Train Loss: 0.4003378748893738, Time taken: 24.666709661483765.
2025-03-21 00:59:12,903 - Start of epoch 12
2025-03-21 00:59:32,206 - epoch 12, Train Loss: 0.39787647128105164, Time taken: 19.30207920074463.
2025-03-21 00:59:33,190 - Start of epoch 13
2025-03-21 00:59:57,427 - epoch 13, Train Loss: 0.3974284827709198, Time taken: 24.237000942230225.
2025-03-21 01:00:04,849 - Start of epoch 14
2025-03-21 01:00:27,715 - epoch 14, Train Loss: 0.39569351077079773, Time taken: 22.86415410041809.
2025-03-21 01:00:28,751 - Start of epoch 15
2025-03-21 01:00:54,158 - epoch 15, Train Loss: 0.3950430750846863, Time taken: 25.405733585357666.
2025-03-21 01:00:55,190 - Start of epoch 16
2025-03-21 01:01:17,758 - epoch 16, Train Loss: 0.39410221576690674, Time taken: 22.567142724990845.
2025-03-21 01:01:18,818 - Start of epoch 17
2025-03-21 01:01:48,634 - epoch 17, Train Loss: 0.3929835259914398, Time taken: 29.81485104560852.
2025-03-21 01:01:49,663 - Start of epoch 18
2025-03-21 01:02:14,698 - epoch 18, Train Loss: 0.39242276549339294, Time taken: 25.03374195098877.
2025-03-21 01:02:15,715 - Start of epoch 19
2025-03-21 01:02:34,455 - epoch 19, Train Loss: 0.3913898766040802, Time taken: 18.73892617225647.
2025-03-21 01:02:35,486 - Start of epoch 20
2025-03-21 01:03:00,225 - epoch 20, Train Loss: 0.3914324939250946, Time taken: 24.73762559890747.
2025-03-21 01:03:01,262 - Start of epoch 21
2025-03-21 01:03:26,691 - epoch 21, Train Loss: 0.3904544711112976, Time taken: 25.428075313568115.
2025-03-21 01:03:27,592 - Start of epoch 22
2025-03-21 01:03:57,581 - epoch 22, Train Loss: 0.39034682512283325, Time taken: 29.98880171775818.
2025-03-21 01:03:58,627 - Start of epoch 23
2025-03-21 01:04:20,545 - epoch 23, Train Loss: 0.38965165615081787, Time taken: 21.916449308395386.
2025-03-21 01:04:21,585 - Start of epoch 24
2025-03-21 01:04:44,792 - epoch 24, Train Loss: 0.3893977701663971, Time taken: 23.205877542495728.
2025-03-21 01:04:45,874 - Start of epoch 25
2025-03-21 01:05:10,083 - epoch 25, Train Loss: 0.3892225921154022, Time taken: 24.207706451416016.
2025-03-21 01:05:11,085 - Start of epoch 26
2025-03-21 01:05:35,335 - epoch 26, Train Loss: 0.3885686993598938, Time taken: 24.249202489852905.
2025-03-21 01:05:36,406 - Start of epoch 27
2025-03-21 01:06:12,331 - epoch 27, Train Loss: 0.38825294375419617, Time taken: 35.92385745048523.
2025-03-21 01:06:13,354 - Start of epoch 28
2025-03-21 01:06:36,264 - epoch 28, Train Loss: 0.38820186257362366, Time taken: 22.909093379974365.
2025-03-21 01:06:37,267 - Start of epoch 29
2025-03-21 01:07:01,458 - epoch 29, Train Loss: 0.3880760073661804, Time taken: 24.190269470214844.
2025-03-21 01:07:02,460 - Start of epoch 30
2025-03-21 01:07:25,699 - epoch 30, Train Loss: 0.38748589158058167, Time taken: 23.237617254257202.
2025-03-21 01:07:26,768 - Start of epoch 31
2025-03-21 01:07:49,603 - epoch 31, Train Loss: 0.38721179962158203, Time taken: 22.834158658981323.
2025-03-21 01:07:50,465 - Start of epoch 32
2025-03-21 01:08:11,767 - epoch 32, Train Loss: 0.38695183396339417, Time taken: 21.301445245742798.
2025-03-21 01:08:12,820 - Start of epoch 33
2025-03-21 01:08:37,846 - epoch 33, Train Loss: 0.3867119252681732, Time taken: 25.024636030197144.
2025-03-21 01:08:38,864 - Start of epoch 34
2025-03-21 01:09:15,459 - epoch 34, Train Loss: 0.386383056640625, Time taken: 36.593149185180664.
2025-03-21 01:09:16,489 - Start of epoch 35
2025-03-21 01:09:39,545 - epoch 35, Train Loss: 0.3864571452140808, Time taken: 23.055779933929443.
2025-03-21 01:09:40,607 - Start of epoch 36
2025-03-21 01:10:04,208 - epoch 36, Train Loss: 0.3861832022666931, Time taken: 23.59924864768982.
2025-03-21 01:10:05,265 - Start of epoch 37
2025-03-21 01:10:29,744 - epoch 37, Train Loss: 0.3859763741493225, Time taken: 24.47796130180359.
2025-03-21 01:10:30,764 - Start of epoch 38
2025-03-21 01:10:50,765 - epoch 38, Train Loss: 0.38593682646751404, Time taken: 20.000043392181396.
2025-03-21 01:10:51,839 - Start of epoch 39
2025-03-21 01:11:14,878 - epoch 39, Train Loss: 0.385886549949646, Time taken: 23.03743004798889.
2025-03-21 01:11:15,892 - Start of epoch 40
2025-03-21 01:11:39,409 - epoch 40, Train Loss: 0.3854479193687439, Time taken: 23.51544761657715.
2025-03-21 01:11:40,476 - Start of epoch 41
2025-03-21 01:12:02,617 - epoch 41, Train Loss: 0.38540005683898926, Time taken: 22.140219926834106.
2025-03-21 01:12:03,902 - Start of epoch 42
2025-03-21 01:12:22,925 - epoch 42, Train Loss: 0.3853379189968109, Time taken: 19.02167272567749.
2025-03-21 01:12:45,497 - Start of epoch 43
2025-03-21 01:13:09,668 - epoch 43, Train Loss: 0.38507288694381714, Time taken: 24.170617818832397.
2025-03-21 01:13:10,594 - Start of epoch 44
2025-03-21 01:13:30,986 - epoch 44, Train Loss: 0.3849291503429413, Time taken: 20.390647888183594.
2025-03-21 01:13:32,015 - Start of epoch 45
2025-03-21 01:13:52,559 - epoch 45, Train Loss: 0.38498494029045105, Time taken: 20.54341197013855.
2025-03-21 01:13:53,584 - Start of epoch 46
2025-03-21 01:14:18,205 - epoch 46, Train Loss: 0.3847828805446625, Time taken: 24.620272159576416.
2025-03-21 01:14:19,089 - Start of epoch 47
2025-03-21 01:14:41,490 - epoch 47, Train Loss: 0.38442474603652954, Time taken: 22.400150060653687.
2025-03-21 01:14:42,384 - Start of epoch 48
2025-03-21 01:15:04,533 - epoch 48, Train Loss: 0.384184330701828, Time taken: 22.148731470108032.
2025-03-21 01:15:05,682 - Start of epoch 49
2025-03-21 01:15:27,760 - epoch 49, Train Loss: 0.384123295545578, Time taken: 22.07647180557251.
2025-03-21 01:15:28,694 - Start of epoch 50
2025-03-21 01:15:48,153 - epoch 50, Train Loss: 0.38396382331848145, Time taken: 19.458353757858276.
2025-03-21 01:15:49,298 - Start of epoch 51
2025-03-21 01:16:14,967 - Saved checkpoint path for step 5101 in epoch 51: /no_backups/d1513/checkpoints/ckpt_cGAN/Train_2025_03_21_00_51_21/ckpt-2
2025-03-21 01:16:14,970 - epoch 51, Train Loss: 0.8950594067573547, Validation Loss: 0.621872067451477, Time taken: 25.671014070510864, The best epoch 51 has the minimum validation loss 0.621872067451477
2025-03-21 01:16:16,797 - Start of epoch 52
2025-03-21 01:16:43,221 - Saved checkpoint path for step 5201 in epoch 52: /no_backups/d1513/checkpoints/ckpt_cGAN/Train_2025_03_21_00_51_21/ckpt-3
2025-03-21 01:16:43,225 - epoch 52, Train Loss: 0.7973693013191223, Validation Loss: 0.4250728189945221, Time taken: 26.42639708518982, The best epoch 52 has the minimum validation loss 0.4250728189945221
2025-03-21 01:16:45,243 - Start of epoch 53
2025-03-21 01:17:37,059 - epoch 53, Train Loss: 0.8841306567192078, Validation Loss: 0.4916175901889801, Time taken: 51.81507682800293, The best epoch 52 has the minimum validation loss 0.4250728189945221
2025-03-21 01:17:39,066 - Start of epoch 54
2025-03-21 01:18:06,117 - Saved checkpoint path for step 5401 in epoch 54: /no_backups/d1513/checkpoints/ckpt_cGAN/Train_2025_03_21_00_51_21/ckpt-4
2025-03-21 01:18:06,121 - epoch 54, Train Loss: 0.891248345375061, Validation Loss: 0.4117649495601654, Time taken: 27.053568363189697, The best epoch 54 has the minimum validation loss 0.4117649495601654
2025-03-21 01:18:08,427 - Start of epoch 55
2025-03-21 01:18:27,837 - Saved checkpoint path for step 5501 in epoch 55: /no_backups/d1513/checkpoints/ckpt_cGAN/Train_2025_03_21_00_51_21/ckpt-5
2025-03-21 01:18:27,839 - epoch 55, Train Loss: 0.8913298845291138, Validation Loss: 0.40545183420181274, Time taken: 19.4112286567688, The best epoch 55 has the minimum validation loss 0.40545183420181274
2025-03-21 01:18:29,553 - Start of epoch 56
2025-03-21 01:18:50,799 - Saved checkpoint path for step 5601 in epoch 56: /no_backups/d1513/checkpoints/ckpt_cGAN/Train_2025_03_21_00_51_21/ckpt-6
2025-03-21 01:18:50,803 - epoch 56, Train Loss: 0.8872374892234802, Validation Loss: 0.4047811031341553, Time taken: 21.248902082443237, The best epoch 56 has the minimum validation loss 0.4047811031341553
2025-03-21 01:18:52,789 - Start of epoch 57
2025-03-21 01:19:18,760 - epoch 57, Train Loss: 0.88580721616745, Validation Loss: 0.4052223265171051, Time taken: 25.969426155090332, The best epoch 56 has the minimum validation loss 0.4047811031341553
2025-03-21 01:19:20,966 - Start of epoch 58
2025-03-21 01:19:44,536 - epoch 58, Train Loss: 0.8827008008956909, Validation Loss: 0.48701876401901245, Time taken: 23.56826114654541, The best epoch 56 has the minimum validation loss 0.4047811031341553
2025-03-21 01:19:46,281 - Start of epoch 59
2025-03-21 01:20:06,687 - epoch 59, Train Loss: 0.8149150013923645, Validation Loss: 0.5610584020614624, Time taken: 20.404056072235107, The best epoch 56 has the minimum validation loss 0.4047811031341553
2025-03-21 01:20:08,376 - Start of epoch 60
2025-03-21 01:20:34,534 - epoch 60, Train Loss: 0.7392313480377197, Validation Loss: 0.5511079430580139, Time taken: 26.157686710357666, The best epoch 56 has the minimum validation loss 0.4047811031341553
2025-03-21 01:20:36,686 - Start of epoch 61
2025-03-21 01:21:00,891 - epoch 61, Train Loss: 0.787264347076416, Validation Loss: 0.5438265800476074, Time taken: 24.2025728225708, The best epoch 56 has the minimum validation loss 0.4047811031341553
2025-03-21 01:21:02,906 - Start of epoch 62
2025-03-21 01:21:26,921 - epoch 62, Train Loss: 0.7396395802497864, Validation Loss: 0.5747467279434204, Time taken: 24.013888359069824, The best epoch 56 has the minimum validation loss 0.4047811031341553
2025-03-21 01:21:29,050 - Start of epoch 63
2025-03-21 01:21:54,750 - epoch 63, Train Loss: 0.7299873232841492, Validation Loss: 0.5733782052993774, Time taken: 25.698777437210083, The best epoch 56 has the minimum validation loss 0.4047811031341553
2025-03-21 01:21:57,080 - Start of epoch 64
2025-03-21 01:22:21,811 - epoch 64, Train Loss: 0.7236085534095764, Validation Loss: 0.5764274597167969, Time taken: 24.730210542678833, The best epoch 56 has the minimum validation loss 0.4047811031341553
2025-03-21 01:22:23,598 - Start of epoch 65
2025-03-21 01:23:23,748 - epoch 65, Train Loss: 0.7208415269851685, Validation Loss: 0.5696778297424316, Time taken: 60.149237871170044, The best epoch 56 has the minimum validation loss 0.4047811031341553
2025-03-21 01:23:25,787 - Start of epoch 66
2025-03-21 01:23:50,092 - epoch 66, Train Loss: 0.7344586253166199, Validation Loss: 0.5812052488327026, Time taken: 24.303916454315186, The best epoch 56 has the minimum validation loss 0.4047811031341553
2025-03-21 01:23:52,188 - ------------------------Early stopping at epoch 66------------------------
2025-03-21 01:23:52,189 - ------------------------End of the training process------------------------
2025-03-21 01:23:52,196 - GIN Configurable Parameters:
# Macros:
# ==============================================================================
batch_size = 8
ckpt_max_to_keep = 5
frame_length = 4
num_chirps = 64
num_samples = 512
processing_method = \
    'padding&shuffle&ap/ph&with_log10&abs_normalization(0,1)&no_angle_normalization'
sampling_rate = 2
whether_fftshift = True

# Parameters for ConditionalGAN:
# ==============================================================================
ConditionalGAN.discriminator_name = 'discriminator'
ConditionalGAN.generator_name = 'DP-Transformer'
ConditionalGAN.input_size_info = \
    [%batch_size, %sampling_rate, %frame_length, %num_samples, %num_chirps]

# Parameters for DPTransformerSTFT:
# ==============================================================================
DPTransformerSTFT.d_model = 64
DPTransformerSTFT.dec_filters = 64
DPTransformerSTFT.dec_kernel_size = 3
DPTransformerSTFT.dff = 64
DPTransformerSTFT.enc_filters = 64
DPTransformerSTFT.enc_kernel_size = 3
DPTransformerSTFT.input_size_info = \
    [%batch_size, %sampling_rate, %frame_length, %num_samples, %num_chirps]
DPTransformerSTFT.maximum_position_encoding = 10000
DPTransformerSTFT.num_dp_layers = 1
DPTransformerSTFT.num_heads = 2
DPTransformerSTFT.num_layers = 1
DPTransformerSTFT.processing_method = %processing_method
DPTransformerSTFT.re_im_split = 0
DPTransformerSTFT.sep_filters = 64
DPTransformerSTFT.strides = 1
DPTransformerSTFT.upsampling_ratio = %sampling_rate

# Parameters for generator_loss:
# ==============================================================================
generator_loss.LAMBDA_gan_loss = 0.5
generator_loss.LAMBDA_l1_loss = 1.0
generator_loss.LAMBDA_perceptual_loss = 0.5

# Parameters for lsd:
# ==============================================================================
lsd.processing_method = %processing_method
lsd.scaling_factor = 1
lsd.thres_type = 'batch_median'

# Parameters for main:
# ==============================================================================
main.benchmark_model_name = 'Interpolation'
main.checkpoint_path = '/no_backups/d1513/checkpoints/'
main.create_tfrecords = False
main.model_name = 'cGAN'
main.tfrecord_suffix = '_factor2'
main.type = 'Train'

# Parameters for plot_range_doppler:
# ==============================================================================
plot_range_doppler.R = 50
plot_range_doppler.cfar = None
plot_range_doppler.fs = 24
plot_range_doppler.vmax = 60
plot_range_doppler.vmin = -80

# Parameters for prepare:
# ==============================================================================
prepare.batch_size = %batch_size
prepare.buffer_size = 50
prepare.caching = False
prepare.shuffle_seed = 42

# Parameters for rD_processing:
# ==============================================================================
rD_processing.whether_fftshift = %whether_fftshift

# Parameters for resolution_calculation:
# ==============================================================================
resolution_calculation.chirp_repetition_time_s = 0.00022
resolution_calculation.end_frequency_GHz = 63
resolution_calculation.num_chirps = %num_chirps
resolution_calculation.start_frequency_GHz = 59

# Parameters for sd_dataset:
# ==============================================================================
sd_dataset.base_dir = '/data/public/rd_sr/dataset_2/'
sd_dataset.disable_tqdm = True
sd_dataset.frame_length = %frame_length
sd_dataset.high_res_processing_type = 'voltage'
sd_dataset.is_high_pass_filter = False
sd_dataset.low_res_processing_type = 'voltage'
sd_dataset.random_state = 42
sd_dataset.sampling_rate = %sampling_rate
sd_dataset.shift_window = %frame_length
sd_dataset.static_remove_duplicates = True
sd_dataset.test_types = ['corridor&medium_tempo']
sd_dataset.tfrecord_folder = '/no_backups/d1513/tfrecord/'
sd_dataset.tqdm_status = False
sd_dataset.train_test_ratio = 0.8
sd_dataset.train_types = ['corridor&slow_tempo', 'corridor&medium_tempo']

# Parameters for Trainer:
# ==============================================================================
Trainer.ckpt_max_to_keep = %ckpt_max_to_keep
Trainer.early_stop_patience = 10
Trainer.early_stop_type = True
Trainer.epochs = 200
Trainer.lambda_disc = 0.0
Trainer.lambda_lsd = 1.0
Trainer.lambda_vgg = 0.5
Trainer.layer_names = \
    ['block1_conv2', 'block2_conv2', 'block3_conv4', 'block4_conv4']
Trainer.learning_rate = 0.001
Trainer.loss_type = 'lsd&frequency_domain'
Trainer.lr_schedule_type = True
Trainer.optimizer_type = 'Adam'
Trainer.overfitting_type = False
Trainer.pretraining = True
Trainer.processing_method = %processing_method

